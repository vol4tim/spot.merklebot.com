(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{1796:function(e,t,n){"use strict";n.r(t);var o=n(14),r=(n(64),n(76),n(44),n(21),n(43),n(1184)),l=n(1903),c=n(1764),f=n(1748),v=n(1765),d=n.n(v),m=(n(1766),n(94)),h=Object(m.b)({components:{VueSlider:d.a},props:["rosUrl","urdfUrl"],setup:function(e){console.log(e);var t=Object(m.f)(null),n=e.urdfUrl,v=Object(m.f)("wait"),d=Object(m.f)(null),h=Object(m.f)(0),w=Object(m.f)(0),x=Object(m.f)(!1),y=Object(m.f)(null),j=[],_=Object(m.f)(null),O=Object(m.f)(null),M=Object(m.f)(null),C=new l.a,P=new r.Scene,z=new r.PlaneGeometry(8,8),F=new r.MeshBasicMaterial({color:"#BBBBBB",side:r.DoubleSide}),I=new r.Mesh(z,F),k=new r.PerspectiveCamera(80,4/3,.1,1e3),B=new r.WebGLRenderer({antialias:!0}),E=new r.DirectionalLight("hsl(0, 100%, 100%)"),T=new r.AxesHelper(5),J=null;k.position.z=-2.3,k.position.y=1.6,k.position.x=-3.8,k.rotation.y=-Math.PI/2-.4,I.rotation.x=Math.PI/2,I.position.y=0,P.add(k),P.add(E),P.add(T),P.add(I),C.load(n,(function(e){var t=new f.a;t.workingPath=r.LoaderUtils.extractUrlBase(n),(J=t.parse(e)).rotation.x=-Math.PI/2,P.add(J),v.value="urdf loaded"})),B.setSize(800,500),E.position.set(5,5,0),P.background=new r.Color("hsl(0, 100%, 100%)");var animate=function animate(){if(setTimeout((function(){requestAnimationFrame(animate)}),1e3/30),B.render(P,k),O.value){var e=O.value;_.value||(_.value={y:e.translation.z,x:e.translation.x,z:-e.translation.y}),J.position.y=e.translation.z-_.value.y+.1,J.position.x=e.translation.x-_.value.x,J.position.z=-e.translation.y-_.value.z;var t=new r.Euler;if(t.setFromQuaternion(new r.Quaternion(e.rotation.x,e.rotation.y,e.rotation.z,e.rotation.w)),J.rotation.x=-t.y-Math.PI/2,J.rotation.y=t.x,J.rotation.z=t.z,null!==M.value)for(var n=M.value,o=0;o<n.position.length;o++)J.joints[n.name[o]].setJointValue(n.position[o])}},R=function(){console.log(x.value);var e=j[h.value];M.value=e.robotJoints,O.value=e.bodyTf,!0===x.value&&h.value<w.value&&(h.value+=1)},A=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y.value&&(clearInterval(y),w.value=0,h.value=0),e.next=3,Object(c.open)(t.value);case 3:return n=e.sent,o=[],r={},e.next=8,n.readMessages({topics:["/tf","/joint_states"]},(function(e){o.push(e),"/joint_states"===e.topic?r.robotJoints||(r.robotJoints=e.message):"/tf"===e.topic&&4===e.message.transforms.length&&e.message.transforms.forEach((function(e){"body"===e.child_frame_id&&(r.bodyTf||(r.bodyTf=e.transform))})),r.bodyTf&&r.robotJoints&&(j.push(Object.assign({},r)),r={})}));case 8:w.value=j.length,console.log("Frames number",w.value),y.value=setInterval((function(){R()}),40);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(m.d)((function(){d.value.appendChild(B.domElement),animate()})),{scene:P,camera:k,renderer:B,light:E,axes:T,stage:d,status:v,onFileChanged:function(e){var n=e.target;n&&n.files&&(t.value=n.files[0],A(),console.log(t.value))},frameNum:h,frameMax:w,sliderChooseFrame:function(e){h.value=e},isPlaying:x,FRAME_WIDTH:800,FRAME_HEIGHT:500}}}),w=h,x=n(25),component=Object(x.a)(w,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[n("input",{attrs:{type:"file"},on:{change:function(t){return e.onFileChanged(t)}}})]),e._v(" "),n("div",[e._v("status: "+e._s(e.status))]),e._v(" "),n("div",{class:{width:e.FRAME_WIDTH}},[n("div",{ref:"stage",staticClass:"stage"}),e._v(" "),e.frameMax>0?n("div",{staticClass:"mt-10 mb-10"},[n("vue-slider",{attrs:{max:e.frameMax,"drag-on-click":!0},on:{change:e.sliderChooseFrame},model:{value:e.frameNum,callback:function(t){e.frameNum=t},expression:"frameNum"}}),e._v(" "),n("div",{staticClass:"mt-4"},[n("button",{staticClass:"rounded bg-blue-500 focus:outline-none m-2 p-2",on:{click:function(){e.isPlaying=!e.isPlaying}}},[n("i",{staticClass:"fa fa-play fa-2x text-white"},[e._v("\n            "+e._s(e.isPlaying?"Stop":"Play")+"\n          ")])])])],1):e._e()])])}),[],!1,null,null,null);t.default=component.exports}}]);